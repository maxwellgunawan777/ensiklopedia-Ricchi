<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ensiklopedia Cilik - Bilingual</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        body { font-family: 'Quicksand', sans-serif; background-color: #E0F2FE; color: #334155; }
        .font-judul { font-family: 'Fredoka One', cursive; }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #94A3B8; border-radius: 10px; }
        .modal-enter { animation: slideUp 0.3s ease-out forwards; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(50px); } to { opacity: 1; transform: translateY(0); } }
        .pill-active { background-color: #0EA5E9; color: white; border-color: #0284C7; }
        .pill-inactive { background-color: white; color: #64748B; border-color: #CBD5E1; }
        .music-pulse { animation: pulseMusic 2s infinite; }
        @keyframes pulseMusic { 0% { box-shadow: 0 0 0 0 rgba(14, 165, 233, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(14, 165, 233, 0); } 100% { box-shadow: 0 0 0 0 rgba(14, 165, 233, 0); } }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden select-none">

    <!-- HEADER -->
    <header class="bg-white p-4 shadow-md z-10 border-b-4 border-sky-200 shrink-0 flex justify-between items-center">
        <div class="flex items-center gap-2">
            <span class="text-3xl">ğŸš€</span>
            <div>
                <h1 id="app-title" class="text-xl md:text-2xl font-judul text-sky-600 tracking-wide">ENSIKLOPEDIA CILIK</h1>
                <p id="app-subtitle" class="text-xs text-slate-400 font-bold">Jelajahi Pengetahuan Dunia!</p>
            </div>
        </div>
        
        <div class="flex items-center gap-3">
            <!-- Language Toggle -->
            <button onclick="window.toggleLanguage()" class="flex items-center gap-1 bg-slate-100 hover:bg-slate-200 px-3 py-1.5 rounded-full border-2 border-slate-200 transition active:scale-95">
                <span id="lang-flag" class="text-xl">ğŸ‡®ğŸ‡©</span>
                <span id="lang-code" class="text-xs font-bold text-slate-600">ID</span>
            </button>

            <!-- Music Toggle -->
            <button id="music-btn" onclick="window.toggleMusic()" class="bg-sky-100 text-sky-500 p-2 rounded-full hover:bg-sky-200 transition relative active:scale-95">
                <span id="music-icon">ğŸ”‡</span>
            </button>
            
            <div class="hidden md:block relative w-64">
                <input type="text" id="search-bar" placeholder="ğŸ” Cari pengetahuan..." class="w-full pl-10 pr-4 py-2 rounded-full border-2 border-slate-200 focus:border-sky-400 focus:outline-none text-sm font-bold bg-white">
                <span class="absolute left-3 top-1/2 -translate-y-1/2 text-sky-300">ğŸ”</span>
            </div>
        </div>
    </header>

    <!-- SEARCH MOBILE -->
    <div class="md:hidden p-3 bg-sky-50 shrink-0">
        <input type="text" id="search-bar-mobile" placeholder="ğŸ” Cari pengetahuan..." class="w-full px-4 py-2 rounded-full border border-sky-200 text-sm shadow-sm">
    </div>

    <!-- FILTER -->
    <div class="py-3 px-4 flex gap-2 overflow-x-auto shrink-0 no-scrollbar bg-sky-50/50">
        <button onclick="window.filterCategory('all')" id="btn-all" class="pill-active px-4 py-1.5 rounded-full border-2 text-xs font-bold whitespace-nowrap transition-colors">Semua</button>
        <button onclick="window.filterCategory('antariksa')" id="btn-antariksa" class="pill-inactive px-4 py-1.5 rounded-full border-2 text-xs font-bold whitespace-nowrap transition-colors">ğŸª Antariksa</button>
        <button onclick="window.filterCategory('hewan')" id="btn-hewan" class="pill-inactive px-4 py-1.5 rounded-full border-2 text-xs font-bold whitespace-nowrap transition-colors">ğŸ¦ Hewan</button>
        <button onclick="window.filterCategory('tubuh')" id="btn-tubuh" class="pill-inactive px-4 py-1.5 rounded-full border-2 text-xs font-bold whitespace-nowrap transition-colors">ğŸ§  Tubuh</button>
        <button onclick="window.filterCategory('alam')" id="btn-alam" class="pill-inactive px-4 py-1.5 rounded-full border-2 text-xs font-bold whitespace-nowrap transition-colors">ğŸŒ‹ Alam</button>
    </div>

    <!-- KONTEN UTAMA -->
    <main id="content-area" class="flex-grow overflow-y-auto p-4 pb-20">
        <div id="cards-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 max-w-5xl mx-auto">
            <!-- Kartu Generated Here -->
        </div>
        <div id="empty-state" class="hidden flex flex-col items-center justify-center mt-20 text-slate-400">
            <span class="text-6xl mb-4 grayscale opacity-50">ğŸ›¸</span>
            <p id="empty-msg" class="font-bold text-lg">Wah, fakta itu belum ada.</p>
        </div>
    </main>

    <!-- MODAL DETAIL -->
    <div id="detail-modal" class="fixed inset-0 bg-slate-900/60 hidden z-50 flex items-end md:items-center justify-center backdrop-blur-sm transition-opacity duration-300">
        <div class="bg-white w-full md:max-w-2xl md:rounded-3xl rounded-t-3xl shadow-2xl overflow-hidden modal-enter flex flex-col max-h-[90vh]">
            
            <!-- Header Modal -->
            <div id="modal-header-bg" class="relative bg-sky-100 p-6 pb-12 text-center transition-colors duration-500">
                <button onclick="window.closeModal()" class="absolute top-4 right-4 bg-black/10 hover:bg-black/20 rounded-full p-2 text-slate-700 transition active:scale-90 font-bold z-20">âœ•</button>
                <div id="modal-emoji" class="text-8xl drop-shadow-xl transform hover:scale-110 transition duration-300 cursor-pointer filter">â˜€ï¸</div>
                <h2 id="modal-title" class="text-3xl font-judul text-slate-800 mt-4 drop-shadow-sm">Judul</h2>
                <span id="modal-category" class="inline-block bg-white/80 px-3 py-1 rounded-full text-xs font-bold text-slate-600 mt-2 uppercase tracking-wider shadow-sm">Kategori</span>
            </div>

            <!-- Body Modal -->
            <div class="p-6 overflow-y-auto flex-grow bg-white relative -mt-8 rounded-t-[2rem] shadow-[0_-10px_40px_rgba(0,0,0,0.1)]">
                
                <div class="flex justify-end -mt-12 mb-4 relative z-10">
                    <button onclick="window.readContent()" class="bg-orange-500 hover:bg-orange-600 text-white px-5 py-2 rounded-full shadow-lg flex items-center gap-2 font-bold text-sm transition active:scale-95 border-2 border-orange-400">
                        <span>ğŸ”Š</span> <span id="btn-read">Baca</span>
                    </button>
                </div>

                <!-- Fakta Poin -->
                <div class="space-y-4 mb-8">
                    <h3 id="fact-header" class="font-bold text-lg text-slate-700 border-b-2 border-slate-100 pb-1 inline-block">Fakta Menarik:</h3>
                    <ul id="modal-content-list" class="space-y-3 text-slate-600 leading-relaxed font-medium">
                        <!-- List items injected via JS -->
                    </ul>
                </div>

                <!-- Kuis -->
                <div class="bg-slate-50 border-2 border-slate-100 rounded-2xl p-5 shadow-inner">
                    <div class="flex items-center gap-2 mb-4">
                        <span class="bg-green-100 text-green-600 p-1.5 rounded-lg text-xl">ğŸ§ </span>
                        <h3 id="quiz-header" class="font-bold text-slate-700 text-lg">Kuis Pintar</h3>
                    </div>
                    <p id="quiz-question" class="font-bold text-slate-800 mb-4 text-base">Pertanyaan...</p>
                    <div id="quiz-options" class="grid grid-cols-1 gap-2"></div>
                    <div id="quiz-feedback" class="mt-4 p-3 rounded-xl text-center font-bold text-sm hidden animate-pulse"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- BACKGROUND MUSIC -->
    <audio id="bg-music" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/11/22/audio_febc508520.mp3" type="audio/mpeg">
    </audio>

    <script type="module">
        // --- DATABASE 100 FAKTA SAINS ---
        const categories = {
            antariksa: { icon: 'ğŸª', color: 'bg-indigo-100', border: 'border-indigo-200', header: 'bg-indigo-200', id: 'Antariksa', en: 'Space' },
            hewan: { icon: 'ğŸ¦', color: 'bg-orange-100', border: 'border-orange-200', header: 'bg-orange-200', id: 'Hewan', en: 'Animals' },
            tubuh: { icon: 'ğŸ§ ', color: 'bg-rose-100', border: 'border-rose-200', header: 'bg-rose-200', id: 'Tubuh', en: 'Body' },
            alam: { icon: 'ğŸŒ‹', color: 'bg-emerald-100', border: 'border-emerald-200', header: 'bg-emerald-200', id: 'Alam', en: 'Nature' }
        };

        // Data Manual (Sample)
        const manualData = [
            {
                id: 1, cat: 'antariksa', emoji: "â˜€ï¸",
                id_data: { title: "Matahari", content: "Matahari adalah bintang raksasa yang sangat panas. Dia terbuat dari gas yang terbakar. Tanpa Matahari, Bumi akan menjadi gelap dan beku.", list: ["Matahari adalah bintang raksasa panas.", "Terbuat dari gas yang terbakar.", "Memberikan cahaya dan panas untuk Bumi."], quiz: { q: "Matahari sebenarnya adalah...", opts: ["Sebuah Planet", "Sebuah Bintang", "Batu Besar"], ans: 1 } },
                en_data: { title: "The Sun", content: "The Sun is a giant star that is very hot. It is made of burning gas. Without the Sun, Earth would be dark and frozen.", list: ["The Sun is a giant hot star.", "It is made of burning gas.", "It gives light and heat to Earth."], quiz: { q: "The Sun is actually a...", opts: ["Planet", "Star", "Rock"], ans: 1 } }
            },
            {
                id: 2, cat: 'antariksa', emoji: "ğŸŒ™",
                id_data: { title: "Bulan", content: "Bulan tidak punya cahaya sendiri. Ia bersinar karena memantulkan cahaya Matahari. Di Bulan tidak ada udara untuk bernapas.", list: ["Bulan memantulkan cahaya Matahari.", "Tidak ada udara di Bulan.", "Bulan mengelilingi Bumi."], quiz: { q: "Cahaya Bulan berasal dari?", opts: ["Bumi", "Lampu", "Matahari"], ans: 2 } },
                en_data: { title: "The Moon", content: "The Moon does not have its own light. It shines by reflecting light from the Sun. There is no air on the Moon to breathe.", list: ["The Moon reflects sunlight.", "There is no air on the Moon.", "The Moon orbits the Earth."], quiz: { q: "Moonlight comes from?", opts: ["Earth", "Lamp", "Sun"], ans: 2 } }
            },
            {
                id: 6, cat: 'hewan', emoji: "ğŸ¦’",
                id_data: { title: "Jerapah", content: "Jerapah adalah hewan tertinggi. Lehernya panjang untuk makan daun di pohon tinggi. Uniknya, tulang lehernya cuma tujuh, sama seperti manusia!", list: ["Hewan tertinggi di dunia.", "Leher panjang untuk makan daun tinggi.", "Punya 7 tulang leher seperti manusia."], quiz: { q: "Apa makanan Jerapah?", opts: ["Daging", "Ikan", "Daun"], ans: 2 } },
                en_data: { title: "Giraffe", content: "Giraffes are the tallest animals. Their long necks help them eat leaves from tall trees. Surprisingly, they only have seven neck bones, just like humans!", list: ["Tallest animal in the world.", "Long neck to eat high leaves.", "Has 7 neck bones like humans."], quiz: { q: "What do Giraffes eat?", opts: ["Meat", "Fish", "Leaves"], ans: 2 } }
            },
            {
                id: 10, cat: 'tubuh', emoji: "â¤ï¸",
                id_data: { title: "Jantung", content: "Jantungmu bekerja seperti pompa. Tugasnya memompa darah ke seluruh tubuh agar kita tetap hidup. 'Duk-duk' di dada itu suara jantungmu bekerja.", list: ["Bekerja seperti pompa otomatis.", "Memompa darah ke seluruh tubuh.", "Berdetak siang dan malam."], quiz: { q: "Apa tugas jantung?", opts: ["Mencerna", "Memompa Darah", "Berpikir"], ans: 1 } },
                en_data: { title: "Heart", content: "Your heart works like a pump. Its job is to pump blood throughout your body to keep you alive. The 'thump-thump' in your chest is your heart working.", list: ["Works like an automatic pump.", "Pumps blood to the whole body.", "Beats day and night."], quiz: { q: "What does the heart do?", opts: ["Digest", "Pump Blood", "Think"], ans: 1 } }
            }
        ];

        // Generator Data Tambahan (Bilingual)
        const subjects = [
            { id_name: "Gajah", en_name: "Elephant", emoji: "ğŸ˜", cat: "hewan", id_trait: "sangat besar", en_trait: "very big" },
            { id_name: "Semut", en_name: "Ant", emoji: "ğŸœ", cat: "hewan", id_trait: "sangat kuat", en_trait: "very strong" },
            { id_name: "Mars", en_name: "Mars", emoji: "ğŸ”´", cat: "antariksa", id_trait: "Planet Merah", en_trait: "Red Planet" },
            { id_name: "Otak", en_name: "Brain", emoji: "ğŸ§ ", cat: "tubuh", id_trait: "pusat pikiran", en_trait: "center of mind" },
            { id_name: "Petir", en_name: "Lightning", emoji: "âš¡", cat: "alam", id_trait: "listrik alam", en_trait: "nature's electricity" }
        ];

        const generatedData = [];
        for (let i = 16; i <= 100; i++) {
            const s = subjects[Math.floor(Math.random() * subjects.length)];
            generatedData.push({
                id: i, cat: s.cat, emoji: s.emoji,
                id_data: { 
                    title: `${s.id_name} #${i}`, 
                    content: `Tahukah kamu? ${s.id_name} itu unik karena ${s.id_trait}. Ini adalah fakta sains yang menarik.`, 
                    list: [`${s.id_name} dikenal ${s.id_trait}.`, "Sangat menarik untuk dipelajari.", "Salah satu keajaiban alam."],
                    quiz: { q: `Apa ciri ${s.id_name}?`, opts: ["Tidak ada", s.id_trait, "Lainnya"], ans: 1 } 
                },
                en_data: { 
                    title: `${s.en_name} #${i}`, 
                    content: `Did you know? The ${s.en_name} is unique because it is ${s.en_trait}. This is an interesting science fact.`, 
                    list: [`${s.en_name} is known to be ${s.en_trait}.`, "Very interesting to learn.", "One of nature's wonders."],
                    quiz: { q: `What is special about ${s.en_name}?`, opts: ["Nothing", s.en_trait, "Other"], ans: 1 } 
                }
            });
        }

        const database = [...manualData, ...generatedData];

        // --- STATE ---
        let currentLang = 'id'; // 'id' or 'en'
        let currentFilter = 'all';
        let currentSearch = '';
        let isMusicPlaying = false;
        let currentItem = null;
        const music = document.getElementById('bg-music');
        music.volume = 0.3;
        const synth = window.speechSynthesis;

        // --- UI LABELS ---
        const labels = {
            id: { title: "ENSIKLOPEDIA CILIK", sub: "Jelajahi 100 Fakta Dunia!", search: "ğŸ” Cari...", all: "Semua", antariksa: "Antariksa", hewan: "Hewan", tubuh: "Tubuh", alam: "Alam", read: "Baca", quiz: "Kuis Pintar", empty: "Wah, fakta itu belum ada.", correct: "ğŸ‰ Hebat! Benar!", wrong: "ğŸ˜… Coba lagi ya!", factHeader: "Fakta Menarik:" },
            en: { title: "LITTLE ENCYCLOPEDIA", sub: "Explore 100 World Facts!", search: "ğŸ” Search...", all: "All", antariksa: "Space", hewan: "Animals", tubuh: "Body", alam: "Nature", read: "Read", quiz: "Smart Quiz", empty: "Fact not found.", correct: "ğŸ‰ Great! Correct!", wrong: "ğŸ˜… Try again!", factHeader: "Fun Facts:" }
        };

        // --- INIT ---
        document.addEventListener('DOMContentLoaded', () => {
            renderCards();
            const sDesktop = document.getElementById('search-bar');
            const sMobile = document.getElementById('search-bar-mobile');
            
            if (sDesktop) sDesktop.addEventListener('input', (e) => window.handleSearch(e.target.value));
            if (sMobile) sMobile.addEventListener('input', (e) => window.handleSearch(e.target.value));
        });

        window.toggleLanguage = function() {
            currentLang = currentLang === 'id' ? 'en' : 'id';
            const l = labels[currentLang];
            const isId = currentLang === 'id';

            document.getElementById('lang-flag').textContent = isId ? 'ğŸ‡®ğŸ‡©' : 'ğŸ‡¬ğŸ‡§';
            document.getElementById('lang-code').textContent = isId ? 'ID' : 'EN';
            document.getElementById('app-title').textContent = l.title;
            document.getElementById('app-subtitle').textContent = l.sub;
            document.getElementById('search-bar').placeholder = l.search;
            document.getElementById('search-bar-mobile').placeholder = l.search;
            document.getElementById('btn-all').textContent = l.all;
            document.getElementById('btn-antariksa').innerHTML = `ğŸª ${l.antariksa}`;
            document.getElementById('btn-hewan').innerHTML = `ğŸ¦ ${l.hewan}`;
            document.getElementById('btn-tubuh').innerHTML = `ğŸ§  ${l.tubuh}`;
            document.getElementById('btn-alam').innerHTML = `ğŸŒ‹ ${l.alam}`;
            document.getElementById('empty-msg').textContent = l.empty;
            
            renderCards();
            if (!document.getElementById('detail-modal').classList.contains('hidden') && currentItem) {
                window.openDetail(currentItem);
            }
        }

        window.toggleMusic = function() {
            const btn = document.getElementById('music-btn');
            const icon = document.getElementById('music-icon');
            if (isMusicPlaying) {
                music.pause(); icon.textContent = 'ğŸ”‡';
                btn.classList.remove('music-pulse', 'bg-sky-500', 'text-white'); btn.classList.add('bg-sky-100', 'text-sky-500');
            } else {
                music.play().catch(e => alert("Tap layar dulu!"));
                icon.textContent = 'ğŸµ';
                btn.classList.add('music-pulse', 'bg-sky-500', 'text-white'); btn.classList.remove('bg-sky-100', 'text-sky-500');
            }
            isMusicPlaying = !isMusicPlaying;
        }

        window.handleSearch = function(val) { currentSearch = val.toLowerCase(); renderCards(); }

        window.filterCategory = function(cat) {
            currentFilter = cat;
            ['all', 'antariksa', 'hewan', 'tubuh', 'alam'].forEach(btn => {
                document.getElementById(`btn-${btn}`).className = btn === cat ? "pill-active px-4 py-1.5 rounded-full border-2 text-xs font-bold whitespace-nowrap transition-colors" : "pill-inactive px-4 py-1.5 rounded-full border-2 text-xs font-bold whitespace-nowrap transition-colors";
            });
            renderCards();
        }

        window.renderCards = function() {
            const container = document.getElementById('cards-grid');
            container.innerHTML = '';
            
            // Handle potential null for search elements if running in limited context
            const sDesktop = document.getElementById('search-bar');
            const sMobile = document.getElementById('search-bar-mobile');
            const term = ((sDesktop ? sDesktop.value : '') || (sMobile ? sMobile.value : '')).toLowerCase();
            
            const filteredData = database.filter(item => {
                const data = currentLang === 'id' ? item.id_data : item.en_data;
                const matchCat = currentFilter === 'all' || item.cat === currentFilter;
                const matchSearch = data.title.toLowerCase().includes(term);
                return matchCat && matchSearch;
            });

            if (filteredData.length === 0) {
                document.getElementById('empty-state').classList.remove('hidden');
            } else {
                document.getElementById('empty-state').classList.add('hidden');
                filteredData.forEach(item => {
                    const data = currentLang === 'id' ? item.id_data : item.en_data;
                    const style = categories[item.cat];
                    const catName = currentLang === 'id' ? style.id : style.en;
                    
                    const div = document.createElement('div');
                    div.className = `bg-white rounded-2xl p-4 border-b-4 ${style.border} shadow-sm cursor-pointer card-hover flex items-center gap-4`;
                    div.onclick = () => window.openDetail(item);
                    
                    div.innerHTML = `
                        <div class="${style.color} w-16 h-16 rounded-2xl flex items-center justify-center text-4xl shrink-0">${item.emoji}</div>
                        <div class="min-w-0">
                            <h3 class="font-judul text-lg text-slate-700 leading-tight truncate">${data.title}</h3>
                            <span class="text-[10px] font-bold uppercase text-slate-400 tracking-wider bg-slate-100 px-2 py-0.5 rounded-md mt-1 inline-block">${catName}</span>
                        </div>
                    `;
                    container.appendChild(div);
                });
            }
        }

        window.openDetail = function(item) {
            currentItem = item;
            const data = currentLang === 'id' ? item.id_data : item.en_data;
            const style = categories[item.cat];
            const catName = currentLang === 'id' ? style.id : style.en;
            const l = labels[currentLang];

            document.getElementById('modal-emoji').textContent = item.emoji;
            document.getElementById('modal-title').textContent = data.title;
            document.getElementById('modal-category').textContent = catName;
            document.getElementById('modal-header-bg').className = `relative ${style.header} p-6 pb-12 text-center transition-colors duration-500`;
            
            // Render Facts List
            const listContainer = document.getElementById('modal-content-list');
            listContainer.innerHTML = data.list.map(txt => `<li class="flex gap-3"><span class="text-sky-500 font-bold text-lg">â€¢</span><span>${txt}</span></li>`).join('');
            
            document.getElementById('fact-header').textContent = l.factHeader;
            document.getElementById('quiz-header').textContent = l.quiz;
            document.getElementById('btn-read').textContent = l.read;
            
            document.getElementById('quiz-question').textContent = data.quiz.q;
            const qContainer = document.getElementById('quiz-options');
            qContainer.innerHTML = '';
            document.getElementById('quiz-feedback').classList.add('hidden');

            data.quiz.opts.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.className = "w-full text-left p-3 rounded-xl border-2 border-slate-200 text-sm font-bold text-slate-600 hover:bg-sky-50 hover:border-sky-300 transition active:scale-95";
                btn.textContent = opt;
                btn.onclick = () => window.checkAnswer(idx, data.quiz.ans, btn);
                qContainer.appendChild(btn);
            });

            document.getElementById('detail-modal').classList.remove('hidden');
        }

        window.closeModal = function() {
            document.getElementById('detail-modal').classList.add('hidden');
            window.speechSynthesis.cancel();
        }

        window.readContent = function() {
            if (!currentItem) return;
            if (isMusicPlaying) music.volume = 0.1;
            window.speechSynthesis.cancel();
            
            const data = currentLang === 'id' ? currentItem.id_data : currentItem.en_data;
            const u = new SpeechSynthesisUtterance(data.title + ". " + data.content);
            u.lang = currentLang === 'id' ? 'id-ID' : 'en-US';
            u.rate = 0.9;
            
            // Auto select voice
            const voices = window.speechSynthesis.getVoices();
            if (currentLang === 'en') {
                u.voice = voices.find(v => v.lang.includes('en-US')) || null;
            } else {
                u.voice = voices.find(v => v.lang.includes('id-ID')) || null;
            }

            u.onend = () => { if (isMusicPlaying) music.volume = 0.3; };
            window.speechSynthesis.speak(u);
        }

        window.checkAnswer = function(sel, cor, btn) {
            const feedback = document.getElementById('quiz-feedback');
            const l = labels[currentLang];
            Array.from(document.getElementById('quiz-options').children).forEach(b => b.disabled = true);
            feedback.classList.remove('hidden');
            
            if (sel === cor) {
                btn.className = "w-full text-left p-3 rounded-xl border-2 bg-green-100 border-green-500 text-green-700 font-bold text-sm";
                feedback.textContent = l.correct;
                feedback.className = "mt-3 text-center font-bold text-sm text-green-600 animate-bounce";
                confetti({ particleCount: 50, spread: 60, origin: { y: 0.8 } });
            } else {
                btn.className = "w-full text-left p-3 rounded-xl border-2 bg-red-100 border-red-500 text-red-700 font-bold text-sm";
                feedback.textContent = l.wrong;
                feedback.className = "mt-3 text-center font-bold text-sm text-red-500";
            }
        }
        
        // Init voices
        window.speechSynthesis.onvoiceschanged = () => window.speechSynthesis.getVoices();

    </script>
</body>
</html>
