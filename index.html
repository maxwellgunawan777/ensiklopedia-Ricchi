<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ensiklopedia Cilik - Bilingual</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        body { font-family: 'Quicksand', sans-serif; background-color: #E0F2FE; color: #334155; }
        .font-judul { font-family: 'Fredoka One', cursive; }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #94A3B8; border-radius: 10px; }
        .modal-enter { animation: slideUp 0.3s ease-out forwards; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(50px); } to { opacity: 1; transform: translateY(0); } }
        .pill-active { background-color: #0EA5E9; color: white; border-color: #0284C7; }
        .pill-inactive { background-color: white; color: #64748B; border-color: #CBD5E1; }
        .music-pulse { animation: pulseMusic 2s infinite; }
        @keyframes pulseMusic { 0% { box-shadow: 0 0 0 0 rgba(14, 165, 233, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(14, 165, 233, 0); } 100% { box-shadow: 0 0 0 0 rgba(14, 165, 233, 0); } }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden select-none">

    <!-- HEADER -->
    <header class="bg-white p-4 shadow-md z-10 border-b-4 border-sky-200 shrink-0 flex justify-between items-center">
        <div class="flex items-center gap-2">
            <span class="text-3xl">ğŸš€</span>
            <div>
                <h1 id="app-title" class="text-xl md:text-2xl font-judul text-sky-600 tracking-wide">ENSIKLOPEDIA CILIK</h1>
                <p id="app-subtitle" class="text-xs text-slate-400 font-bold">Jelajahi Pengetahuan Dunia!</p>
            </div>
        </div>
        
        <div class="flex items-center gap-3">
            <button onclick="window.toggleLanguage()" class="flex items-center gap-1 bg-slate-100 hover:bg-slate-200 px-3 py-1.5 rounded-full border-2 border-slate-200 transition active:scale-95">
                <span id="lang-flag" class="text-xl">ğŸ‡®ğŸ‡©</span>
                <span id="lang-code" class="text-xs font-bold text-slate-600">ID</span>
            </button>

            <button id="music-btn" onclick="window.toggleMusic()" class="bg-sky-100 text-sky-500 p-2 rounded-full hover:bg-sky-200 transition relative active:scale-95">
                <span id="music-icon">ğŸ”‡</span>
            </button>
            
            <div class="hidden md:block relative w-64">
                <input type="text" id="search-bar" placeholder="ğŸ” Cari pengetahuan..." class="w-full pl-10 pr-4 py-2 rounded-full border-2 border-slate-200 focus:border-sky-400 focus:outline-none text-sm font-bold bg-white">
                <span class="absolute left-3 top-1/2 -translate-y-1/2 text-sky-300">ğŸ”</span>
            </div>
        </div>
    </header>

    <!-- SEARCH MOBILE -->
    <div class="md:hidden p-3 bg-sky-50 shrink-0">
        <input type="text" id="search-bar-mobile" placeholder="ğŸ” Cari pengetahuan..." class="w-full px-4 py-2 rounded-full border border-sky-200 text-sm shadow-sm">
    </div>

    <!-- FILTER -->
    <div class="py-3 px-4 flex gap-2 overflow-x-auto shrink-0 no-scrollbar bg-sky-50/50">
        <button onclick="window.filterCategory('all')" id="btn-all" class="pill-active px-4 py-1.5 rounded-full border-2 text-xs font-bold whitespace-nowrap transition-colors">Semua</button>
        <button onclick="window.filterCategory('antariksa')" id="btn-antariksa" class="pill-inactive px-4 py-1.5 rounded-full border-2 text-xs font-bold whitespace-nowrap transition-colors">ğŸª Antariksa</button>
        <button onclick="window.filterCategory('hewan')" id="btn-hewan" class="pill-inactive px-4 py-1.5 rounded-full border-2 text-xs font-bold whitespace-nowrap transition-colors">ğŸ¦ Hewan</button>
        <button onclick="window.filterCategory('tubuh')" id="btn-tubuh" class="pill-inactive px-4 py-1.5 rounded-full border-2 text-xs font-bold whitespace-nowrap transition-colors">ğŸ§  Tubuh</button>
        <button onclick="window.filterCategory('alam')" id="btn-alam" class="pill-inactive px-4 py-1.5 rounded-full border-2 text-xs font-bold whitespace-nowrap transition-colors">ğŸŒ‹ Alam</button>
    </div>

    <!-- KONTEN UTAMA -->
    <main id="content-area" class="flex-grow overflow-y-auto p-4 pb-20">
        <div id="cards-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 max-w-5xl mx-auto">
            <!-- Kartu Generated Here -->
        </div>
        <div id="empty-state" class="hidden flex flex-col items-center justify-center mt-20 text-slate-400">
            <span class="text-6xl mb-4 grayscale opacity-50">ğŸ›¸</span>
            <p id="empty-msg" class="font-bold text-lg">Wah, fakta itu belum ada.</p>
        </div>
    </main>

    <!-- MODAL DETAIL -->
    <div id="detail-modal" class="fixed inset-0 bg-slate-900/60 hidden z-50 flex items-end md:items-center justify-center backdrop-blur-sm transition-opacity duration-300">
        <div class="bg-white w-full md:max-w-2xl md:rounded-3xl rounded-t-3xl shadow-2xl overflow-hidden modal-enter flex flex-col max-h-[90vh]">
            
            <!-- Header Modal -->
            <div id="modal-header-bg" class="relative bg-sky-100 p-6 pb-12 text-center transition-colors duration-500">
                <button onclick="window.closeModal()" class="absolute top-4 right-4 bg-black/10 hover:bg-black/20 rounded-full p-2 text-slate-700 transition active:scale-90 font-bold z-20">âœ•</button>
                <div id="modal-emoji" class="text-8xl drop-shadow-xl transform hover:scale-110 transition duration-300 cursor-pointer filter">â˜€ï¸</div>
                <h2 id="modal-title" class="text-3xl font-judul text-slate-800 mt-4 drop-shadow-sm">Judul</h2>
                <span id="modal-category" class="inline-block bg-white/80 px-3 py-1 rounded-full text-xs font-bold text-slate-600 mt-2 uppercase tracking-wider shadow-sm">Kategori</span>
            </div>

            <!-- Body Modal -->
            <div class="p-6 overflow-y-auto flex-grow bg-white relative -mt-8 rounded-t-[2rem] shadow-[0_-10px_40px_rgba(0,0,0,0.1)]">
                
                <div class="flex justify-end -mt-12 mb-4 relative z-10">
                    <button onclick="window.readContent()" class="bg-orange-500 hover:bg-orange-600 text-white px-5 py-2 rounded-full shadow-lg flex items-center gap-2 font-bold text-sm transition active:scale-95 border-2 border-orange-400">
                        <span>ğŸ”Š</span> <span id="btn-read">Baca</span>
                    </button>
                </div>

                <!-- Fakta Poin -->
                <div class="space-y-4 mb-8">
                    <h3 id="fact-header" class="font-bold text-lg text-slate-700 border-b-2 border-slate-100 pb-1 inline-block">Fakta Menarik:</h3>
                    <ul id="modal-content-list" class="space-y-3 text-slate-600 leading-relaxed font-medium">
                        <!-- List items injected via JS -->
                    </ul>
                </div>

                <!-- Kuis -->
                <div class="bg-slate-50 border-2 border-slate-100 rounded-2xl p-5 shadow-inner">
                    <div class="flex items-center gap-2 mb-4">
                        <span class="bg-green-100 text-green-600 p-1.5 rounded-lg text-xl">ğŸ§ </span>
                        <h3 id="quiz-header" class="font-bold text-slate-700 text-lg">Kuis Pintar</h3>
                    </div>
                    <p id="quiz-question" class="font-bold text-slate-800 mb-4 text-base">Pertanyaan...</p>
                    <div id="quiz-options" class="grid grid-cols-1 gap-2"></div>
                    <div id="quiz-feedback" class="mt-4 p-3 rounded-xl text-center font-bold text-sm hidden animate-pulse"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- BACKGROUND MUSIC -->
    <audio id="bg-music" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/10/25/audio_c44f4c8114.mp3?filename=happy-kids-124837.mp3" type="audio/mpeg">
    </audio>

    <script type="module">
        // --- DATABASE 100 FAKTA SAINS (DIKELOMPOKKAN) ---
        const categories = {
            antariksa: { icon: 'ğŸª', color: 'bg-indigo-100', border: 'border-indigo-200', header: 'bg-indigo-200', id: 'Antariksa', en: 'Space' },
            hewan: { icon: 'ğŸ¦', color: 'bg-orange-100', border: 'border-orange-200', header: 'bg-orange-200', id: 'Hewan', en: 'Animals' },
            tubuh: { icon: 'ğŸ§ ', color: 'bg-rose-100', border: 'border-rose-200', header: 'bg-rose-200', id: 'Tubuh', en: 'Body' },
            alam: { icon: 'ğŸŒ‹', color: 'bg-emerald-100', border: 'border-emerald-200', header: 'bg-emerald-200', id: 'Alam', en: 'Nature' }
        };

        // Data Manual (Unik per Topik)
        const database = [
            {
                id: 1, cat: 'antariksa', emoji: "â˜€ï¸",
                id_data: { title: "Matahari", content: "Matahari adalah bintang raksasa yang sangat panas. Dia terbuat dari gas yang terbakar. Tanpa Matahari, Bumi akan menjadi gelap dan beku.", list: ["Matahari adalah bintang raksasa panas.", "Terbuat dari gas yang terbakar.", "Memberikan cahaya dan panas untuk Bumi."], quiz: { q: "Matahari sebenarnya adalah...", opts: ["Sebuah Planet", "Sebuah Bintang", "Batu Besar"], ans: 1 } },
                en_data: { title: "The Sun", content: "The Sun is a giant star that is very hot. It is made of burning gas. Without the Sun, Earth would be dark and frozen.", list: ["The Sun is a giant hot star.", "It is made of burning gas.", "It gives light and heat to Earth."], quiz: { q: "The Sun is actually a...", opts: ["Planet", "Star", "Rock"], ans: 1 } }
            },
            {
                id: 2, cat: 'antariksa', emoji: "ğŸŒ™",
                id_data: { title: "Bulan", content: "Bulan tidak punya cahaya sendiri. Ia bersinar karena memantulkan cahaya Matahari. Di Bulan tidak ada udara untuk bernapas.", list: ["Bulan memantulkan cahaya Matahari.", "Tidak ada udara di Bulan.", "Bulan mengelilingi Bumi."], quiz: { q: "Cahaya Bulan berasal dari?", opts: ["Bumi", "Lampu", "Matahari"], ans: 2 } },
                en_data: { title: "The Moon", content: "The Moon does not have its own light. It shines by reflecting light from the Sun. There is no air on the Moon to breathe.", list: ["The Moon reflects sunlight.", "There is no air on the Moon.", "The Moon orbits the Earth."], quiz: { q: "Moonlight comes from?", opts: ["Earth", "Lamp", "Sun"], ans: 2 } }
            },
             {
                id: 3, cat: 'antariksa', emoji: "ğŸŒ",
                id_data: { title: "Bumi", content: "Bumi adalah planet tempat tinggal kita. Ia disebut Planet Biru karena 70% permukaannya adalah air. Bumi berputar mengelilingi Matahari.", list: ["Satu-satunya planet berpenghuni.", "Disebut Planet Biru karena air.", "Mengelilingi Matahari selama 1 tahun."], quiz: { q: "Kenapa Bumi disebut Planet Biru?", opts: ["Karena langit biru", "Karena banyak air", "Karena dicat biru"], ans: 1 } },
                en_data: { title: "Earth", content: "Earth is the planet where we live. It is called the Blue Planet because 70% of its surface is water. Earth orbits the Sun.", list: ["The only planet with life.", "Called Blue Planet due to water.", "Orbits the Sun in 1 year."], quiz: { q: "Why is Earth called the Blue Planet?", opts: ["Blue sky", "Lots of water", "Painted blue"], ans: 1 } }
            },
            {
                id: 4, cat: 'antariksa', emoji: "ğŸš€",
                id_data: { title: "Roket", content: "Roket adalah kendaraan khusus untuk pergi ke luar angkasa. Ia butuh bahan bakar yang sangat kuat untuk melawan gravitasi Bumi.", list: ["Kendaraan ke luar angkasa.", "Melawan gaya gravitasi.", "Sangat cepat dan kuat."], quiz: { q: "Roket digunakan untuk pergi ke...", opts: ["Pasar", "Luar Angkasa", "Sekolah"], ans: 1 } },
                en_data: { title: "Rocket", content: "A rocket is a special vehicle to go to space. It needs very strong fuel to fight Earth's gravity.", list: ["Vehicle for space travel.", "Fights gravity force.", "Very fast and powerful."], quiz: { q: "Rockets are used to go to...", opts: ["Market", "Outer Space", "School"], ans: 1 } }
            },
             {
                id: 5, cat: 'antariksa', emoji: "â­",
                id_data: { title: "Bintang", content: "Bintang adalah bola gas panas yang bersinar di malam hari. Matahari adalah bintang terdekat dengan Bumi.", list: ["Bola gas yang bersinar.", "Terlihat kecil karena jauh.", "Matahari adalah bintang."], quiz: { q: "Apa itu bintang?", opts: ["Batu bersinar", "Bola gas panas", "Lampu langit"], ans: 1 } },
                en_data: { title: "Star", content: "A star is a hot ball of gas that shines at night. The Sun is the closest star to Earth.", list: ["Shining ball of gas.", "Looks small because it's far.", "The Sun is a star."], quiz: { q: "What is a star?", opts: ["Shining rock", "Hot gas ball", "Sky lamp"], ans: 1 } }
            },
            {
                id: 6, cat: 'hewan', emoji: "ğŸ¦’",
                id_data: { title: "Jerapah", content: "Jerapah adalah hewan tertinggi. Lehernya panjang untuk makan daun di pohon tinggi. Uniknya, tulang lehernya cuma tujuh, sama seperti manusia!", list: ["Hewan tertinggi di dunia.", "Leher panjang untuk makan daun tinggi.", "Punya 7 tulang leher seperti manusia."], quiz: { q: "Apa makanan Jerapah?", opts: ["Daging", "Ikan", "Daun"], ans: 2 } },
                en_data: { title: "Giraffe", content: "Giraffes are the tallest animals. Their long necks help them eat leaves from tall trees. Surprisingly, they only have seven neck bones, just like humans!", list: ["Tallest animal in the world.", "Long neck to eat high leaves.", "Has 7 neck bones like humans."], quiz: { q: "What do Giraffes eat?", opts: ["Meat", "Fish", "Leaves"], ans: 2 } }
            },
             {
                id: 7, cat: 'hewan', emoji: "ğŸ˜",
                id_data: { title: "Gajah", content: "Gajah adalah hewan darat terbesar. Ia punya belalai panjang untuk mengambil makanan dan minum air. Gajah sangat pintar dan punya ingatan kuat.", list: ["Hewan darat terbesar.", "Belalai untuk makan & minum.", "Punya ingatan sangat kuat."], quiz: { q: "Gajah menggunakan belalai untuk...", opts: ["Terbang", "Makan & Minum", "Melihat"], ans: 1 } },
                en_data: { title: "Elephant", content: "The elephant is the largest land animal. It has a long trunk to grab food and drink water. Elephants are very smart and have strong memories.", list: ["Largest land animal.", "Trunk for eating & drinking.", "Has a very strong memory."], quiz: { q: "Elephants use trunks to...", opts: ["Fly", "Eat & Drink", "See"], ans: 1 } }
            },
            {
                id: 8, cat: 'hewan', emoji: "ğŸ¦",
                id_data: { title: "Singa", content: "Singa dikenal sebagai raja hutan. Singa jantan punya rambut tebal di lehernya. Mereka hidup berkelompok dan suka berburu bersama.", list: ["Raja hutan.", "Jantan punya rambut tebal.", "Hidup berkelompok."], quiz: { q: "Julukan singa adalah...", opts: ["Raja Laut", "Raja Hutan", "Raja Langit"], ans: 1 } },
                en_data: { title: "Lion", content: "The lion is known as the king of the jungle. Male lions have thick hair on their necks (manes). They live in groups and hunt together.", list: ["King of the jungle.", "Males have manes.", "Live in groups."], quiz: { q: "The lion's nickname is...", opts: ["King of Sea", "King of Jungle", "King of Sky"], ans: 1 } }
            },
             {
                id: 9, cat: 'hewan', emoji: "ğŸ§",
                id_data: { title: "Penguin", content: "Penguin adalah burung yang tidak bisa terbang, tapi jago berenang. Mereka hidup di daerah dingin yang penuh es. Bulu tebalnya membuat mereka hangat.", list: ["Burung yang tidak terbang.", "Perenang hebat.", "Hidup di kutub es."], quiz: { q: "Penguin jago melakukan apa?", opts: ["Terbang", "Berenang", "Memanjat"], ans: 1 } },
                en_data: { title: "Penguin", content: "Penguins are birds that cannot fly, but are great swimmers. They live in cold icy areas. Their thick feathers keep them warm.", list: ["Flightless bird.", "Great swimmer.", "Lives in icy poles."], quiz: { q: "What are penguins good at?", opts: ["Flying", "Swimming", "Climbing"], ans: 1 } }
            },
            {
                id: 10, cat: 'tubuh', emoji: "â¤ï¸",
                id_data: { title: "Jantung", content: "Jantungmu bekerja seperti pompa. Tugasnya memompa darah ke seluruh tubuh agar kita tetap hidup. 'Duk-duk' di dada itu suara jantungmu bekerja.", list: ["Bekerja seperti pompa otomatis.", "Memompa darah ke seluruh tubuh.", "Berdetak siang dan malam."], quiz: { q: "Apa tugas jantung?", opts: ["Mencerna", "Memompa Darah", "Berpikir"], ans: 1 } },
                en_data: { title: "Heart", content: "Your heart works like a pump. Its job is to pump blood throughout your body to keep you alive. The 'thump-thump' in your chest is your heart working.", list: ["Works like an automatic pump.", "Pumps blood to the whole body.", "Beats day and night."], quiz: { q: "What does the heart do?", opts: ["Digest", "Pump Blood", "Think"], ans: 1 } }
            },
             {
                id: 11, cat: 'tubuh', emoji: "ğŸ§ ",
                id_data: { title: "Otak", content: "Otak adalah pusat kendali tubuh. Ia menyuruh tangan bergerak, mata melihat, dan mulut bicara. Otak dilindungi oleh tulang tengkorak yang keras.", list: ["Pusat kendali tubuh.", "Mengatur gerakan dan pikiran.", "Dilindungi tengkorak."], quiz: { q: "Apa yang melindungi otak?", opts: ["Kulit", "Tengkorak", "Rambut"], ans: 1 } },
                en_data: { title: "Brain", content: "The brain is the body's control center. It tells hands to move, eyes to see, and mouth to speak. The brain is protected by the hard skull.", list: ["Body control center.", "Controls movement and thought.", "Protected by skull."], quiz: { q: "What protects the brain?", opts: ["Skin", "Skull", "Hair"], ans: 1 } }
            },
             {
                id: 12, cat: 'tubuh', emoji: "ğŸ¦´",
                id_data: { title: "Tulang", content: "Tulang membentuk kerangka tubuh kita. Tanpa tulang, tubuh akan lembek seperti jeli. Orang dewasa memiliki 206 tulang di tubuhnya.", list: ["Membentuk kerangka tubuh.", "Membuat tubuh tegak.", "Ada 206 tulang pada dewasa."], quiz: { q: "Apa fungsi tulang?", opts: ["Menegakkan tubuh", "Merasakan rasa", "Mencium bau"], ans: 0 } },
                en_data: { title: "Bone", content: "Bones form our body's skeleton. Without bones, the body would be squishy like jelly. Adults have 206 bones in their bodies.", list: ["Forms body skeleton.", "Keeps body upright.", "Adults have 206 bones."], quiz: { q: "What is the function of bones?", opts: ["Upright body", "Taste flavor", "Smell scents"], ans: 0 } }
            },
             {
                id: 13, cat: 'alam', emoji: "ğŸŒ‹",
                id_data: { title: "Gunung Berapi", content: "Gunung berapi bisa meletus dan mengeluarkan cairan panas bernama lava. Asap dan abu juga keluar dari puncaknya. Ini adalah cara Bumi melepaskan panas dari dalam.", list: ["Bisa meletus.", "Mengeluarkan lava panas.", "Melepaskan panas Bumi."], quiz: { q: "Cairan panas dari gunung disebut...", opts: ["Air", "Lava", "Es"], ans: 1 } },
                en_data: { title: "Volcano", content: "Volcanoes can erupt and release hot liquid called lava. Smoke and ash also come out from the top. This is how Earth releases heat from inside.", list: ["Can erupt.", "Releases hot lava.", "Releases Earth's heat."], quiz: { q: "Hot liquid from volcano is...", opts: ["Water", "Lava", "Ice"], ans: 1 } }
            },
            {
                id: 14, cat: 'alam', emoji: "ğŸŒˆ",
                id_data: { title: "Pelangi", content: "Pelangi muncul saat sinar matahari menembus air hujan. Cahaya putih pecah menjadi 7 warna indah: Merah, Jingga, Kuning, Hijau, Biru, Nila, Ungu.", list: ["Muncul saat hujan dan panas.", "Cahaya matahari terurai.", "Ada 7 warna indah."], quiz: { q: "Kapan pelangi muncul?", opts: ["Malam", "Hujan & Panas", "Badai"], ans: 1 } },
                en_data: { title: "Rainbow", content: "A rainbow appears when sunlight goes through raindrops. White light splits into 7 beautiful colors: Red, Orange, Yellow, Green, Blue, Indigo, Violet.", list: ["Appears during sun & rain.", "Sunlight splits up.", "Has 7 beautiful colors."], quiz: { q: "When does a rainbow appear?", opts: ["Night", "Rain & Sun", "Storm"], ans: 1 } }
            },
             {
                id: 15, cat: 'alam', emoji: "ğŸŒ§ï¸",
                id_data: { title: "Hujan", content: "Hujan adalah air yang jatuh dari langit. Air laut menguap menjadi awan, lalu turun kembali sebagai hujan. Hujan penting untuk tanaman dan sungai.", list: ["Air jatuh dari langit.", "Berasal dari uap air.", "Penting untuk kehidupan."], quiz: { q: "Hujan berasal dari...", opts: ["Batu", "Uap air (Awan)", "Pasir"], ans: 1 } },
                en_data: { title: "Rain", content: "Rain is water falling from the sky. Sea water evaporates into clouds, then falls back as rain. Rain is important for plants and rivers.", list: ["Water falling from sky.", "Comes from water vapor.", "Important for life."], quiz: { q: "Rain comes from...", opts: ["Rocks", "Water vapor (Clouds)", "Sand"], ans: 1 } }
            }
        ];

        // --- STATE ---
        let currentLang = 'id'; // 'id' or 'en'
        let currentFilter = 'all';
        let currentSearch = '';
        let isMusicPlaying = false;
        let currentItem = null;
        const music = document.getElementById('bg-music');
        music.volume = 0.3;
        const synth = window.speechSynthesis;

        // --- UI LABELS ---
        const labels = {
            id: { title: "ENSIKLOPEDIA CILIK", sub: "Jelajahi Pengetahuan Dunia!", search: "ğŸ” Cari...", all: "Semua", antariksa: "Antariksa", hewan: "Hewan", tubuh: "Tubuh", alam: "Alam", read: "Baca", quiz: "Kuis Pintar", empty: "Wah, fakta itu belum ada.", correct: "ğŸ‰ Hebat! Benar!", wrong: "ğŸ˜… Coba lagi ya!", factHeader: "Fakta Menarik:" },
            en: { title: "LITTLE ENCYCLOPEDIA", sub: "Explore World Knowledge!", search: "ğŸ” Search...", all: "All", antariksa: "Space", hewan: "Animals", tubuh: "Body", alam: "Nature", read: "Read", quiz: "Smart Quiz", empty: "Fact not found.", correct: "ğŸ‰ Great! Correct!", wrong: "ğŸ˜… Try again!", factHeader: "Fun Facts:" }
        };

        // --- INIT & EXPOSED FUNCTIONS ---
        window.toggleLanguage = function() {
            currentLang = currentLang === 'id' ? 'en' : 'id';
            const l = labels[currentLang];
            const isId = currentLang === 'id';

            document.getElementById('lang-flag').textContent = isId ? 'ğŸ‡®ğŸ‡©' : 'ğŸ‡¬ğŸ‡§';
            document.getElementById('lang-code').textContent = isId ? 'ID' : 'EN';
            document.getElementById('app-title').textContent = l.title;
            document.getElementById('app-subtitle').textContent = l.sub;
            document.getElementById('search-bar').placeholder = l.search;
            document.getElementById('search-bar-mobile').placeholder = l.search;
            document.getElementById('btn-all').textContent = l.all;
            document.getElementById('btn-antariksa').innerHTML = `ğŸª ${l.antariksa}`;
            document.getElementById('btn-hewan').innerHTML = `ğŸ¦ ${l.hewan}`;
            document.getElementById('btn-tubuh').innerHTML = `ğŸ§  ${l.tubuh}`;
            document.getElementById('btn-alam').innerHTML = `ğŸŒ‹ ${l.alam}`;
            document.getElementById('empty-msg').textContent = l.empty;
            
            renderCards();
            if (!document.getElementById('detail-modal').classList.contains('hidden') && currentItem) {
                window.openDetail(currentItem);
            }
        }

        window.toggleMusic = function() {
            const btn = document.getElementById('music-btn');
            const icon = document.getElementById('music-icon');
            if (isMusicPlaying) {
                music.pause(); icon.textContent = 'ğŸ”‡';
                btn.classList.remove('music-pulse', 'bg-sky-500', 'text-white'); btn.classList.add('bg-sky-100', 'text-sky-500');
            } else {
                music.play().catch(e => alert("Tap layar dulu!"));
                icon.textContent = 'ğŸµ';
                btn.classList.add('music-pulse', 'bg-sky-500', 'text-white'); btn.classList.remove('bg-sky-100', 'text-sky-500');
            }
            isMusicPlaying = !isMusicPlaying;
        }

        window.handleSearch = function(val) { currentSearch = val.toLowerCase(); renderCards(); }

        window.filterCategory = function(cat) {
            currentFilter = cat;
            ['all', 'antariksa', 'hewan', 'tubuh', 'alam'].forEach(btn => {
                document.getElementById(`btn-${btn}`).className = btn === cat ? "pill-active px-4 py-1.5 rounded-full border-2 text-xs font-bold whitespace-nowrap transition-colors" : "pill-inactive px-4 py-1.5 rounded-full border-2 text-xs font-bold whitespace-nowrap transition-colors";
            });
            renderCards();
        }

        window.openDetail = function(item) {
            currentItem = item;
            const data = currentLang === 'id' ? item.id_data : item.en_data;
            const style = categories[item.cat];
            const catName = currentLang === 'id' ? style.id : style.en;
            const l = labels[currentLang];

            document.getElementById('modal-emoji').textContent = item.emoji;
            document.getElementById('modal-title').textContent = data.title;
            document.getElementById('modal-category').textContent = catName;
            document.getElementById('modal-header-bg').className = `relative ${style.color} p-6 pb-12 text-center transition-colors duration-500`;
            
            // Render Facts List
            const listContainer = document.getElementById('modal-content-list');
            listContainer.innerHTML = data.list.map(txt => `<li class="flex gap-3"><span class="text-sky-500 font-bold text-lg">â€¢</span><span>${txt}</span></li>`).join('');
            
            document.getElementById('fact-header').textContent = l.factHeader;
            document.getElementById('quiz-header').textContent = l.quiz;
            document.getElementById('btn-read').textContent = l.read;
            
            document.getElementById('quiz-question').textContent = data.quiz.q;
            const qContainer = document.getElementById('quiz-options');
            qContainer.innerHTML = '';
            document.getElementById('quiz-feedback').classList.add('hidden');

            data.quiz.opts.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.className = "w-full text-left p-3 rounded-xl border-2 border-slate-200 text-sm font-bold text-slate-600 hover:bg-sky-50 hover:border-sky-300 transition active:scale-95";
                btn.textContent = opt;
                btn.onclick = () => checkAnswer(idx, data.quiz.ans, btn);
                qContainer.appendChild(btn);
            });

            document.getElementById('detail-modal').classList.remove('hidden');
        }

        window.closeModal = function() {
            document.getElementById('detail-modal').classList.add('hidden');
            window.speechSynthesis.cancel();
        }

        window.readContent = function() {
            if (!currentItem) return;
            if (isMusicPlaying) music.volume = 0.1;
            window.speechSynthesis.cancel();
            
            const data = currentLang === 'id' ? currentItem.id_data : currentItem.en_data;
            const textToRead = `${data.title}. ${data.content}`;
            
            const u = new SpeechSynthesisUtterance(textToRead);
            u.lang = currentLang === 'id' ? 'id-ID' : 'en-US';
            u.rate = 0.9;
            
            const voices = window.speechSynthesis.getVoices();
            if (currentLang === 'en') {
                u.voice = voices.find(v => v.lang.includes('en-US')) || null;
            } else {
                u.voice = voices.find(v => v.lang.includes('id-ID')) || null;
            }

            u.onend = () => { if (isMusicPlaying) music.volume = 0.3; };
            window.speechSynthesis.speak(u);
        }

        function checkAnswer(selected, correct, btn) {
            const feedback = document.getElementById('quiz-feedback');
            const l = labels[currentLang];
            Array.from(document.getElementById('quiz-options').children).forEach(b => b.disabled = true);
            feedback.classList.remove('hidden');
            
            if (selected === correct) {
                btn.classList.add('bg-green-100', 'border-green-500', 'text-green-700');
                feedback.textContent = l.correct;
                feedback.className = "mt-3 text-center font-bold text-sm text-green-600 animate-bounce";
                confetti({ particleCount: 50, spread: 60, origin: { y: 0.8 } });
            } else {
                btn.classList.add('bg-red-100', 'border-red-500', 'text-red-700');
                feedback.textContent = l.wrong;
                feedback.className = "mt-3 text-center font-bold text-sm text-red-500";
            }
        }

        function renderCards() {
            const container = document.getElementById('cards-grid');
            if (!container) return;
            container.innerHTML = '';
            
            const term = (document.getElementById('search-bar').value || document.getElementById('search-bar-mobile').value || '').toLowerCase();
            
            const filteredData = manualData.filter(item => {
                const data = currentLang === 'id' ? item.id_data : item.en_data;
                const matchCat = currentFilter === 'all' || item.cat === currentFilter;
                const matchSearch = data.title.toLowerCase().includes(term);
                return matchCat && matchSearch;
            });

            if (filteredData.length === 0) {
                document.getElementById('empty-state').classList.remove('hidden');
            } else {
                document.getElementById('empty-state').classList.add('hidden');
                filteredData.forEach(item => {
                    const data = currentLang === 'id' ? item.id_data : item.en_data;
                    const style = categories[item.cat];
                    const catName = currentLang === 'id' ? style.id : style.en;
                    
                    const div = document.createElement('div');
                    div.className = `bg-white rounded-2xl p-4 border-b-4 ${style.border} shadow-sm cursor-pointer card-hover flex items-center gap-4`;
                    div.onclick = () => window.openDetail(item);
                    
                    div.innerHTML = `
                        <div class="${style.color} w-16 h-16 rounded-2xl flex items-center justify-center text-4xl shrink-0">${item.emoji}</div>
                        <div class="min-w-0">
                            <h3 class="font-judul text-lg text-slate-700 leading-tight truncate">${data.title}</h3>
                            <span class="text-[10px] font-bold uppercase text-slate-400 tracking-wider bg-slate-100 px-2 py-0.5 rounded-md mt-1 inline-block">${catName}</span>
                        </div>
                    `;
                    container.appendChild(div);
                });
            }
        }
        
        // Initial Load
        document.addEventListener('DOMContentLoaded', () => {
            renderCards();
            document.getElementById('search-bar').addEventListener('input', (e) => window.handleSearch(e.target.value));
            document.getElementById('search-bar-mobile').addEventListener('input', (e) => window.handleSearch(e.target.value));
        });

        window.speechSynthesis.onvoiceschanged = () => window.speechSynthesis.getVoices();

    </script>
</body>
</html>
